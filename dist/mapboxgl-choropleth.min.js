!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Choropleth=e()}}(function(){return function o(i,f,u){function c(t,e){if(!f[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var a=f[t]={exports:{}};i[t][0].call(a.exports,function(e){return c(i[t][1][e]||e)},a,a.exports,o,i,f,u)}return f[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default={mapboxAccessToken:"pk.eyJ1IjoiYW9zaWthIiwiYSI6IjQzRGIxeEkifQ.7OvmyBbXwwt9Qxjlh9Qd3w"}},{}],2:[function(e,Ce,Ae){(function(){var C,a,f,A,u,i,d,b,c,l,s,h,ae,E,p,r,e,n,t,oe,g,o,j,m,y,v,w,ie,k,_,x,L,M,P,N,O,S,R,q,B,F,G,T,I,Y,Q,K,fe,X,z,ue,D,U,H,ce,V,$,W,Z,J,ee,te,ne,re,le,se,he,de,pe,be,ge,ye,ve,we,ke,_e,xe,Le,Me,Pe,Ne=[].slice;_e=function(){var n,e,t,r,a;for(n={},r=0,e=(a="Boolean Number String Function Array Date RegExp Undefined Null".split(" ")).length;r<e;r++)t=a[r],n["[object "+t+"]"]=t.toLowerCase();return function(e){var t;return t=Object.prototype.toString.call(e),n[t]||"object"}}(),K=function(e,t,n){return null==t&&(t=0),null==n&&(n=1),e<t&&(e=t),n<e&&(e=n),e},xe=function(e){return 3<=e.length?Array.prototype.slice.call(e):e[0]},g=function(e){var t,n;for(e._clipped=!1,e._unclipped=e.slice(0),t=n=0;n<3;t=++n)t<3?((e[t]<0||255<e[t])&&(e._clipped=!0),e[t]<0&&(e[t]=0),255<e[t]&&(e[t]=255)):3===t&&(e[t]<0&&(e[t]=0),1<e[t]&&(e[t]=1));return e._clipped||delete e._unclipped,e},A=Math.PI,ge=Math.round,j=Math.cos,ie=Math.floor,ce=Math.pow,fe=Math.log,ve=Math.sin,we=Math.sqrt,E=Math.atan2,ue=Math.max,ae=Math.abs,d=2*A,u=A/3,a=A/180,i=180/A,(oe=function(){return arguments[0]instanceof C?arguments[0]:function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,arguments,function(){})}).default=oe,h=[],null!=Ce&&null!=Ce.exports&&(Ce.exports=oe),((null!=Ae?Ae:this).chroma=oe).version="1.3.7",s={},l=!(c=[]),C=function(){function e(){var e,t,n,r,a,o,i,f,u;for(o=this,t=[],f=0,r=arguments.length;f<r;f++)null!=(e=arguments[f])&&t.push(e);if(1<t.length&&(i=t[t.length-1]),null!=s[i])o._rgb=g(s[i](xe(t.slice(0,-1))));else{for(l||(c=c.sort(function(e,t){return t.p-e.p}),l=!0),u=0,a=c.length;u<a&&!(i=(n=c[u]).test.apply(n,t));u++);i&&(o._rgb=g(s[i].apply(s,t)))}null==o._rgb&&console.warn("unknown format: "+t),null==o._rgb&&(o._rgb=[0,0,0]),3===o._rgb.length&&o._rgb.push(1)}return e.prototype.toString=function(){return this.hex()},e.prototype.clone=function(){return oe(me._rgb)},e}(),oe._input=s,oe.brewer=n={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},function(){var e,t;for(e in t=[],n)t.push(n[e.toLowerCase()]=n[e])}(),oe.colors=Le={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},G=function(){var e,t,n,r,a,o,i;return r=(t=xe(arguments))[0],e=t[1],n=t[2],o=(r+16)/116,a=isNaN(e)?o:o+e/500,i=isNaN(n)?o:o-n/200,o=f.Yn*T(o),a=f.Xn*T(a),i=f.Zn*T(i),[Pe(3.2404542*a-1.5371385*o-.4985314*i),Pe(-.969266*a+1.8760108*o+.041556*i),n=Pe(.0556434*a-.2040259*o+1.0572252*i),3<t.length?t[3]:1]},Pe=function(e){return 255*(e<=.00304?12.92*e:1.055*ce(e,1/2.4)-.055)},T=function(e){return e>f.t1?e*e*e:f.t2*(e-f.t0)},f={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ne=function(){var e,t,n,r,a,o,i;return n=(r=xe(arguments))[0],t=r[1],e=r[2],o=(a=de(n,t,e))[0],[116*(i=a[1])-16,500*(o-i),200*(i-a[2])]},pe=function(e){return(e/=255)<=.04045?e/12.92:ce((e+.055)/1.055,2.4)},Me=function(e){return e>f.t3?ce(e,1/3):e/f.t2+f.t0},de=function(){var e,t,n,r;return n=(r=xe(arguments))[0],t=r[1],e=r[2],n=pe(n),t=pe(t),e=pe(e),[Me((.4124564*n+.3575761*t+.1804375*e)/f.Xn),Me((.2126729*n+.7151522*t+.072175*e)/f.Yn),Me((.0193339*n+.119192*t+.9503041*e)/f.Zn)]},oe.lab=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["lab"]),function(){})},s.lab=G,C.prototype.lab=function(){return ne(this._rgb)},p=function(r){var e,t,n,a,o,i,f,u,c,l,s;return 2===(r=function(){var e,t,n;for(n=[],t=0,e=r.length;t<e;t++)a=r[t],n.push(oe(a));return n}()).length?(c=function(){var e,t,n;for(n=[],t=0,e=r.length;t<e;t++)a=r[t],n.push(a.lab());return n}(),o=c[0],i=c[1],e=function(n){var r,e;return e=function(){var e,t;for(t=[],r=e=0;e<=2;r=++e)t.push(o[r]+n*(i[r]-o[r]));return t}(),oe.lab.apply(oe,e)}):3===r.length?(l=function(){var e,t,n;for(n=[],t=0,e=r.length;t<e;t++)a=r[t],n.push(a.lab());return n}(),o=l[0],i=l[1],f=l[2],e=function(n){var r,e;return e=function(){var e,t;for(t=[],r=e=0;e<=2;r=++e)t.push((1-n)*(1-n)*o[r]+2*(1-n)*n*i[r]+n*n*f[r]);return t}(),oe.lab.apply(oe,e)}):4===r.length?(s=function(){var e,t,n;for(n=[],t=0,e=r.length;t<e;t++)a=r[t],n.push(a.lab());return n}(),o=s[0],i=s[1],f=s[2],u=s[3],e=function(n){var r,e;return e=function(){var e,t;for(t=[],r=e=0;e<=2;r=++e)t.push((1-n)*(1-n)*(1-n)*o[r]+3*(1-n)*(1-n)*n*i[r]+3*(1-n)*n*n*f[r]+n*n*n*u[r]);return t}(),oe.lab.apply(oe,e)}):5===r.length&&(t=p(r.slice(0,3)),n=p(r.slice(2,5)),e=function(e){return e<.5?t(2*e):n(2*(e-.5))}),e},oe.bezier=function(e){var t;return(t=p(e)).scale=function(){return oe.scale(t)},t},oe.cubehelix=function(i,f,u,c,l){var s,h,t;return null==i&&(i=300),null==f&&(f=-1.5),null==u&&(u=1),null==c&&(c=1),null==l&&(l=[0,1]),s=0,"array"===_e(l)?h=l[1]-l[0]:(h=0,l=[l,l]),(t=function(e){var t,n,r,a,o;return t=d*((i+120)/360+f*e),a=ce(l[0]+h*e,c),n=(0!==s?u[0]+e*s:u)*a*(1-a)/2,r=j(t),o=ve(t),oe(g([255*(a+n*(-.14861*r+1.78277*o)),255*(a+n*(-.29227*r-.90649*o)),255*(a+n*(1.97294*r))]))}).start=function(e){return null==e?i:(i=e,t)},t.rotations=function(e){return null==e?f:(f=e,t)},t.gamma=function(e){return null==e?c:(c=e,t)},t.hue=function(e){return null==e?u:("array"===_e(u=e)?0===(s=u[1]-u[0])&&(u=u[1]):s=0,t)},t.lightness=function(e){return null==e?l:("array"===_e(e)?h=(l=e)[1]-e[0]:(l=[e,e],h=0),t)},t.scale=function(){return oe.scale(t)},t.hue(u),t},oe.random=function(){var e,t;for("0123456789abcdef",e="#",t=0;t<6;++t)e+="0123456789abcdef".charAt(ie(16*Math.random()));return new C(e)},h=[],N=function(e,t,n,r){var a,o,i,f;for(null==n&&(n=.5),null==r&&(r="rgb"),"object"!==_e(e)&&(e=oe(e)),"object"!==_e(t)&&(t=oe(t)),i=0,o=h.length;i<o;i++)if(r===(a=h[i])[0]){f=a[1](e,t,n,r);break}if(null==f)throw"color mode "+r+" is not supported";return f.alpha(e.alpha()+n*(t.alpha()-e.alpha()))},oe.interpolate=N,C.prototype.interpolate=function(e,t,n){return N(this,e,t,n)},oe.mix=N,C.prototype.mix=C.prototype.interpolate,s.rgb=function(){var e,t,n,r;for(e in n=[],t=xe(arguments))r=t[e],n.push(r);return n},oe.rgb=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["rgb"]),function(){})},C.prototype.rgb=function(e){return null==e&&(e=!0),e?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)},C.prototype.rgba=function(e){return null==e&&(e=!0),e?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)},c.push({p:3,test:function(e){var t;return t=xe(arguments),"array"===_e(t)&&3===t.length?"rgb":4===t.length&&"number"===_e(t[3])&&0<=t[3]&&t[3]<=1?"rgb":void 0}}),s.lrgb=s.rgb,R=function(e,t,n,r){var a,o;return a=e._rgb,o=t._rgb,new C(we(ce(a[0],2)*(1-n)+ce(o[0],2)*n),we(ce(a[1],2)*(1-n)+ce(o[1],2)*n),we(ce(a[2],2)*(1-n)+ce(o[2],2)*n),r)},b=function(e){var t,n,r,a,o;for(t=1/e.length,o=[0,0,0,0],r=0,n=e.length;r<n;r++)a=e[r]._rgb,o[0]+=ce(a[0],2)*t,o[1]+=ce(a[1],2)*t,o[2]+=ce(a[2],2)*t,o[3]+=a[3]*t;return o[0]=we(o[0]),o[1]=we(o[1]),o[2]=we(o[2]),new C(o)},h.push(["lrgb",R]),oe.average=function(e,t){var n,r,a,o,i,f,u,c,l,s,h,d,p;if(null==t&&(t="rgb"),l=e.length,u=(e=e.map(function(e){return oe(e)})).splice(0,1)[0],"lrgb"===t)return b(e);for(c in o=[],f=i=0,d=u.get(t))d[c]=d[c]||0,o.push(isNaN(d[c])?0:1),"h"!==t.charAt(c)||isNaN(d[c])||(n=d[c]/180*A,i+=j(n),f+=ve(n));for(r=u.alpha(),h=0,s=e.length;h<s;h++)for(c in p=(a=e[h]).get(t),r+=a.alpha(),d)isNaN(p[c])||(o[c]+=1,"h"===t.charAt(c)?(n=p[c]/180*A,i+=j(n),f+=ve(n)):d[c]+=p[c]);for(c in d)if("h"===t.charAt(c)){for(n=E(f/o[c],i/o[c])/A*180;n<0;)n+=360;for(;360<=n;)n-=360;d[c]=n}else d[c]=d[c]/o[c];return oe(d,t).alpha(r/l)},_=function(e){var t,n;if(e.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return 4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]),[(n=parseInt(e,16))>>16,n>>8&255,255&n,1];if(e.match(/^#?([A-Fa-f0-9]{8})$/))return 9===e.length&&(e=e.substr(1)),[(n=parseInt(e,16))>>24&255,n>>16&255,n>>8&255,ge((255&n)/255*100)/100];if(null!=s.css&&(t=s.css(e)))return t;throw"unknown color: "+e},Z=function(e,t){var n,r,a,o,i,f;return null==t&&(t="rgb"),i=e[0],a=e[1],r=e[2],n=e[3],i=Math.round(i),a=Math.round(a),r=Math.round(r),f=(f="000000"+(i<<16|a<<8|r).toString(16)).substr(f.length-6),o=(o="0"+ge(255*n).toString(16)).substr(o.length-2),"#"+function(){switch(t.toLowerCase()){case"rgba":return f+o;case"argb":return o+f;default:return f}}()},s.hex=function(e){return _(e)},oe.hex=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["hex"]),function(){})},C.prototype.hex=function(e){return null==e&&(e="rgb"),Z(this._rgb,e)},c.push({p:4,test:function(e){if(1===arguments.length&&"string"===_e(e))return"hex"}}),M=function(){var e,t,n,r,a,o,i,f,u,c,l,s,h,d;if(a=(e=xe(arguments))[0],l=e[1],i=e[2],0===l)u=r=t=255*i;else{for(n=[0,0,0],s=2*i-(h=i<.5?i*(1+l):i+l-i*l),(d=[0,0,0])[0]=(a/=360)+1/3,d[1]=a,d[2]=a-1/3,o=f=0;f<=2;o=++f)d[o]<0&&(d[o]+=1),1<d[o]&&(d[o]-=1),6*d[o]<1?n[o]=s+6*(h-s)*d[o]:2*d[o]<1?n[o]=h:3*d[o]<2?n[o]=s+(h-s)*(2/3-d[o])*6:n[o]=s;u=(c=[ge(255*n[0]),ge(255*n[1]),ge(255*n[2])])[0],r=c[1],t=c[2]}return 3<e.length?[u,r,t,e[3]]:[u,r,t]},ee=function(e,t,n){var r,a,o,i,f;return void 0!==e&&3<=e.length&&(e=(i=e)[0],t=i[1],n=i[2]),e/=255,t/=255,n/=255,o=Math.min(e,t,n),a=((ue=Math.max(e,t,n))+o)/2,ue===o?(f=0,r=Number.NaN):f=a<.5?(ue-o)/(ue+o):(ue-o)/(2-ue-o),e===ue?r=(t-n)/(ue-o):t===ue?r=2+(n-e)/(ue-o):n===ue&&(r=4+(e-t)/(ue-o)),(r*=60)<0&&(r+=360),[r,f,a]},oe.hsl=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["hsl"]),function(){})},s.hsl=M,C.prototype.hsl=function(){return ee(this._rgb)},P=function(){var e,t,n,r,a,o,i,f,u,c,l,s,h,d,p,b,g,m;if(a=(e=xe(arguments))[0],b=e[1],m=e[2],m*=255,0===b)u=r=t=m;else switch(360===a&&(a=0),360<a&&(a-=360),a<0&&(a+=360),i=m*(1-b),f=m*(1-b*(n=(a/=60)-(o=ie(a)))),g=m*(1-b*(1-n)),o){case 0:u=(c=[m,g,i])[0],r=c[1],t=c[2];break;case 1:u=(l=[f,m,i])[0],r=l[1],t=l[2];break;case 2:u=(s=[i,m,g])[0],r=s[1],t=s[2];break;case 3:u=(h=[i,f,m])[0],r=h[1],t=h[2];break;case 4:u=(d=[g,i,m])[0],r=d[1],t=d[2];break;case 5:u=(p=[m,i,f])[0],r=p[1],t=p[2]}return[u,r,t,3<e.length?e[3]:1]},te=function(){var e,t,n,r,a,o,i,f,u;return o=(i=xe(arguments))[0],n=i[1],e=i[2],a=Math.min(o,n,e),t=(ue=Math.max(o,n,e))-a,u=ue/255,0===ue?(r=Number.NaN,f=0):(f=t/ue,o===ue&&(r=(n-e)/t),n===ue&&(r=2+(e-o)/t),e===ue&&(r=4+(o-n)/t),(r*=60)<0&&(r+=360)),[r,f,u]},oe.hsv=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["hsv"]),function(){})},s.hsv=P,C.prototype.hsv=function(){return te(this._rgb)},U=function(e){return"number"===_e(e)&&0<=e&&e<=16777215?[e>>16,e>>8&255,255&e,1]:(console.warn("unknown num color: "+e),[0,0,0,1])},se=function(){var e;return((e=xe(arguments))[0]<<16)+(e[1]<<8)+e[2]},oe.num=function(e){return new C(e,"num")},C.prototype.num=function(e){return null==e&&(e="rgb"),se(this._rgb,e)},s.num=U,c.push({p:1,test:function(e){if(1===arguments.length&&"number"===_e(e)&&0<=e&&e<=16777215)return"num"}}),k=function(){var e,t,n,r,a,o,i,f,u,c,l,s,h,d,p,b,g,m,y,v;if(f=(n=xe(arguments))[0],a=n[1],t=n[2],i=i/100*255,e=255*(a/=100),0===a)s=i=r=t;else switch(360===f&&(f=0),360<f&&(f-=360),f<0&&(f+=360),l=(c=t*(1-a))+e*(1-(o=(f/=60)-(u=ie(f)))),y=c+e*o,v=c+e,u){case 0:s=(h=[v,y,c])[0],i=h[1],r=h[2];break;case 1:s=(d=[l,v,c])[0],i=d[1],r=d[2];break;case 2:s=(p=[c,v,y])[0],i=p[1],r=p[2];break;case 3:s=(b=[c,l,v])[0],i=b[1],r=b[2];break;case 4:s=(g=[y,c,v])[0],i=g[1],r=g[2];break;case 5:s=(m=[v,c,l])[0],i=m[1],r=m[2]}return[s,i,r,3<n.length?n[3]:1]},W=function(){var e,t,n,r,a,o,i,f,u;return f=(u=xe(arguments))[0],a=u[1],t=u[2],i=Math.min(f,a,t),n=100*(r=(ue=Math.max(f,a,t))-i)/255,e=i/(255-r)*100,0===r?o=Number.NaN:(f===ue&&(o=(a-t)/r),a===ue&&(o=2+(t-f)/r),t===ue&&(o=4+(f-a)/r),(o*=60)<0&&(o+=360)),[o,n,e]},oe.hcg=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["hcg"]),function(){})},s.hcg=k,C.prototype.hcg=function(){return W(this._rgb)},m=function(e){var t,n,r,a,o,i,f,u;if(e=e.toLowerCase(),null!=oe.colors&&oe.colors[e])return _(oe.colors[e]);if(o=e.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(f=o.slice(1,4),a=i=0;i<=2;a=++i)f[a]=+f[a];f[3]=1}else if(o=e.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(f=o.slice(1,5),a=u=0;u<=3;a=++u)f[a]=+f[a];else if(o=e.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(f=o.slice(1,4),a=t=0;t<=2;a=++t)f[a]=ge(2.55*f[a]);f[3]=1}else if(o=e.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(f=o.slice(1,5),a=n=0;n<=2;a=++n)f[a]=ge(2.55*f[a]);f[3]=+f[3]}else(o=e.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?((r=o.slice(1,4))[1]*=.01,r[2]*=.01,(f=M(r))[3]=1):(o=e.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&((r=o.slice(1,4))[1]*=.01,r[2]*=.01,(f=M(r))[3]=+o[4]);return f},$=function(e){var t;return"rgb"===(t=e[3]<1?"rgba":"rgb")?t+"("+e.slice(0,3).map(ge).join(",")+")":"rgba"===t?t+"("+e.slice(0,3).map(ge).join(",")+","+e[3]+")":void 0},be=function(e){return ge(100*e)/100},L=function(e,t){var n;return n=t<1?"hsla":"hsl",e[0]=be(e[0]||0),e[1]=be(100*e[1])+"%",e[2]=be(100*e[2])+"%","hsla"===n&&(e[3]=t),n+"("+e.join(",")+")"},s.css=function(e){return m(e)},oe.css=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["css"]),function(){})},C.prototype.css=function(e){return null==e&&(e="rgb"),"rgb"===e.slice(0,3)?$(this._rgb):"hsl"===e.slice(0,3)?L(this.hsl(),this.alpha()):void 0},s.named=function(e){return _(Le[e])},c.push({p:5,test:function(e){if(1===arguments.length&&null!=Le[e])return"named"}}),C.prototype.name=function(e){var t,n;for(n in arguments.length&&(Le[e]&&(this._rgb=_(Le[e])),this._rgb[3]=1),t=this.hex(),Le)if(t===Le[n])return n;return t},I=function(){var e,t,n,r;return n=(r=xe(arguments))[0],e=r[1],t=r[2],[n,j(t*=a)*e,ve(t)*e]},Y=function(){var e,t,n,r,a,o,i,f,u;return i=(n=xe(arguments))[0],a=n[1],o=n[2],e=(f=I(i,a,o))[0],t=f[1],r=f[2],[(u=G(e,t,r))[0],u[1],r=u[2],3<n.length?n[3]:1]},F=function(){var e,t,n,r,a,o;return a=(o=xe(arguments))[0],e=o[1],t=o[2],n=we(e*e+t*t),r=(E(t,e)*i+360)%360,0===ge(1e4*n)&&(r=Number.NaN),[a,n,r]},re=function(){var e,t,n,r,a,o,i;return a=(o=xe(arguments))[0],n=o[1],t=o[2],r=(i=ne(a,n,t))[0],e=i[1],t=i[2],F(r,e,t)},oe.lch=function(){var e;return e=xe(arguments),new C(e,"lch")},oe.hcl=function(){var e;return e=xe(arguments),new C(e,"hcl")},s.lch=Y,s.hcl=function(){var e,t,n,r;return t=(r=xe(arguments))[0],e=r[1],n=r[2],Y([n,e,t])},C.prototype.lch=function(){return re(this._rgb)},C.prototype.hcl=function(){return re(this._rgb).reverse()},V=function(e){var t,n,r,a,o,i;return null==e&&(e="rgb"),o=(i=xe(arguments))[0],r=i[1],t=i[2],r/=255,t/=255,[(1-(o/=255)-(a=1-Math.max(o,Math.max(r,t))))*(n=a<1?1/(1-a):0),(1-r-a)*n,(1-t-a)*n,a]},o=function(){var e,t,n,r,a,o;return n=(t=xe(arguments))[0],a=t[1],o=t[2],r=t[3],e=4<t.length?t[4]:1,1===r?[0,0,0,e]:[1<=n?0:255*(1-n)*(1-r),1<=a?0:255*(1-a)*(1-r),1<=o?0:255*(1-o)*(1-r),e]},s.cmyk=function(){return o(xe(arguments))},oe.cmyk=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["cmyk"]),function(){})},C.prototype.cmyk=function(){return V(this._rgb)},s.gl=function(){var e,n,t,r,a;for(r=function(){var e,t;for(n in t=[],e=xe(arguments))a=e[n],t.push(a);return t}.apply(this,arguments),e=t=0;t<=2;e=++t)r[e]*=255;return r},oe.gl=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["gl"]),function(){})},C.prototype.gl=function(){var e;return[(e=this._rgb)[0]/255,e[1]/255,e[2]/255,e[3]]},le=function(e,t,n){var r;return e=(r=xe(arguments))[0],t=r[1],n=r[2],.2126*(e=X(e))+.7152*(t=X(t))+.0722*(n=X(n))},X=function(e){return(e/=255)<=.03928?e/12.92:ce((e+.055)/1.055,2.4)},B=function(e,t,n,r){var a,o;return a=e._rgb,o=t._rgb,new C(a[0]+n*(o[0]-a[0]),a[1]+n*(o[1]-a[1]),a[2]+n*(o[2]-a[2]),r)},h.push(["rgb",B]),C.prototype.luminance=function(a,o){var e,i,t,f;return null==o&&(o="rgb"),arguments.length?(t=this._rgb,0===a?t=[0,0,0,this._rgb[3]]:1===a?t=[255,255,255,this[3]]:(e=le(this._rgb),1e-7,i=20,f=function(e,t){var n,r;return n=(r=e.interpolate(t,.5,o)).luminance(),Math.abs(a-n)<1e-7||!i--?r:a<n?f(e,r):f(r,t)},t=a<e?f(oe("black"),this).rgba():f(this,oe("white")).rgba()),oe(t).alpha(this.alpha())):le(this._rgb)},ke=function(e){var t,n,r,a;return(a=e/100)<66?(r=255,n=-155.25485562709179-.44596950469579133*(n=a-2)+104.49216199393888*fe(n),t=a<20?0:.8274096064007395*(t=a-10)-254.76935184120902+115.67994401066147*fe(t)):(r=351.97690566805693+.114206453784165*(r=a-55)-40.25366309332127*fe(r),n=325.4494125711974+.07943456536662342*(n=a-50)-28.0852963507957*fe(n),t=255),[r,n,t]},he=function(){var e,t,n,r,a,o,i;for(r=(a=xe(arguments))[0],a[1],e=a[2],n=1e3,t=4e4,.4;.4<t-n;)(o=ke(i=.5*(t+n)))[2]/o[0]>=e/r?t=i:n=i;return ge(i)},oe.temperature=oe.kelvin=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["temperature"]),function(){})},s.temperature=s.kelvin=s.K=ke,C.prototype.temperature=function(){return he(this._rgb)},C.prototype.kelvin=C.prototype.temperature,oe.contrast=function(e,t){var n,r,a,o;return"string"!==(a=_e(e))&&"number"!==a||(e=new C(e)),"string"!==(o=_e(t))&&"number"!==o||(t=new C(t)),n=e.luminance(),(r=t.luminance())<n?(n+.05)/(r+.05):(r+.05)/(n+.05)},oe.distance=function(e,t,n){var r,a,o,i,f,u,c;for(a in null==n&&(n="lab"),"string"!==(f=_e(e))&&"number"!==f||(e=new C(e)),"string"!==(u=_e(t))&&"number"!==u||(t=new C(t)),o=e.get(n),i=t.get(n),c=0,o)c+=(r=(o[a]||0)-(i[a]||0))*r;return Math.sqrt(c)},oe.deltaE=function(e,t,n,r){var a,o,i,f,u,c,l,s,h,d,p,b,g,m,y,v,w,k,_,x,L,M,P,N;for(null==n&&(n=1),null==r&&(r=1),"string"!==(y=_e(e))&&"number"!==y||(e=new C(e)),"string"!==(v=_e(t))&&"number"!==v||(t=new C(t)),a=(w=e.lab())[0],i=w[1],u=w[2],o=(k=t.lab())[0],f=k[1],c=k[2],l=we(i*i+u*u),s=we(f*f+c*c),x=a<16?.511:.040975*a/(1+.01765*a),_=.0638*l/(1+.0131*l)+.638,m=l<1e-6?0:180*E(u,i)/A;m<0;)m+=360;for(;360<=m;)m-=360;return L=164<=m&&m<=345?.56+ae(.2*j(A*(m+168)/180)):.36+ae(.4*j(A*(m+35)/180)),g=we((h=l*l*l*l)/(h+1900)),we((M=(a-o)/(n*x))*M+(P=(b=l-s)/(r*_))*P+((d=i-f)*d+(p=u-c)*p-b*b)/((N=_*(g*L+1-g))*N))},C.prototype.get=function(e){var t,n,r,a,o;return this,r=(a=e.split("."))[0],t=a[1],o=this[r](),t?-1<(n=r.indexOf(t))?o[n]:console.warn("unknown channel "+t+" in mode "+r):o},C.prototype.set=function(e,t){var n,r,a,o,i;if(this,a=(o=e.split("."))[0],n=o[1])if(i=this[a](),-1<(r=a.indexOf(n)))if("string"===_e(t))switch(t.charAt(0)){case"+":case"-":i[r]+=+t;break;case"*":i[r]*=+t.substr(1);break;case"/":i[r]/=+t.substr(1);break;default:i[r]=+t}else i[r]=t;else console.warn("unknown channel "+n+" in mode "+a);else i=t;return oe(i,a).alpha(this.alpha())},C.prototype.clipped=function(){return this._rgb._clipped||!1},C.prototype.alpha=function(e){return arguments.length?oe.rgb([this._rgb[0],this._rgb[1],this._rgb[2],e]):this._rgb[3]},C.prototype.darken=function(e){var t;return null==e&&(e=1),(t=this.lab())[0]-=f.Kn*e,oe.lab(t).alpha(this.alpha())},C.prototype.brighten=function(e){return null==e&&(e=1),this.darken(-e)},C.prototype.darker=C.prototype.darken,C.prototype.brighter=C.prototype.brighten,C.prototype.saturate=function(e){var t;return null==e&&(e=1),(t=this.lch())[1]+=e*f.Kn,t[1]<0&&(t[1]=0),oe.lch(t).alpha(this.alpha())},C.prototype.desaturate=function(e){return null==e&&(e=1),this.saturate(-e)},C.prototype.premultiply=function(){var e,t;return t=this.rgb(),e=this.alpha(),oe(t[0]*e,t[1]*e,t[2]*e,e)},D=function(e,t){return e*t/255},y=function(e,t){return t<e?t:e},Q=function(e,t){return t<e?e:t},ye=function(e,t){return 255*(1-(1-e/255)*(1-t/255))},H=function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))},t=function(e,t){return 255*(1-(1-t/255)/(e/255))},v=function(e,t){return 255===e?255:255<(e=t/255*255/(1-e/255))?255:e},(r=function(e,t,n){if(!r[n])throw"unknown blend mode "+n;return r[n](e,t)}).normal=(e=function(a){return function(e,t){var n,r;return n=oe(t).rgb(),r=oe(e).rgb(),oe(a(n,r),"rgb")}})((w=function(o){return function(e,t){var n,r,a;for(a=[],n=r=0;r<=3;n=++r)a[n]=o(e[n],t[n]);return a}})(function(e,t){return e})),r.multiply=e(w(D)),r.screen=e(w(ye)),r.overlay=e(w(H)),r.darken=e(w(y)),r.lighten=e(w(Q)),r.dodge=e(w(v)),r.burn=e(w(t)),oe.blend=r,oe.analyze=function(e){var t,n,r,a;for(r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},n=0,t=e.length;n<t;n++)null==(a=e[n])||isNaN(a)||(r.values.push(a),r.sum+=a,a<r.min&&(r.min=a),a>r.max&&(r.max=a),r.count+=1);return r.domain=[r.min,r.max],r.limits=function(e,t){return oe.limits(r,e,t)},r},oe.scale=function(l,e){var s,c,h,t,d,p,b,g,m,y,n,v,w,i,k,_,x,L,f,r,M;return m="rgb",y=oe("#ccc"),!1,d=[i=0,1],w=[],s=!(v=[0,0]),n=!(h=[]),g=0,c={},k=!(t=!(b=1)),p=1,r=function(e){var t,n,r,a,o,i;if(null==e&&(e=["#fff","#000"]),null!=e&&"string"===_e(e)&&null!=oe.brewer&&(e=oe.brewer[e]||oe.brewer[e.toLowerCase()]||e),"array"===_e(e)){for(t=r=0,a=(e=e.slice(0)).length-1;0<=a?r<=a:a<=r;t=0<=a?++r:--r)n=e[t],"string"===_e(n)&&(e[t]=oe(n));for(t=i=w.length=0,o=e.length-1;0<=o?i<=o:o<=i;t=0<=o?++i:--i)w.push(t/(e.length-1))}return f(),h=e},x=function(e){var t,n;if(null!=s){for(n=s.length-1,t=0;t<n&&e>=s[t];)t++;return t-1}return 0},M=function(e){return e},function(e){var t,n,r,a,o;return o=e,2<s.length&&(a=s.length-1,t=x(e),r=s[0]+(s[1]-s[0])*(0+.5*i),n=s[a-1]+(s[a]-s[a-1])*(1-.5*i),o=g+(s[t]+.5*(s[t+1]-s[t])-r)/(n-r)*(b-g)),o},L=function(e,t){var n,r,a,o,i,f,u;if(null==t&&(t=!1),isNaN(e))return y;if(u=t?e:s&&2<s.length?x(e)/(s.length-2):b!==g?(e-g)/(b-g):1,t||(u=M(u)),1!==p&&(u=ce(u,p)),u=v[0]+u*(1-v[0]-v[1]),u=Math.min(1,Math.max(0,u)),a=Math.floor(1e4*u),k&&c[a])n=c[a];else{if("array"===_e(h))for(r=o=0,f=w.length-1;0<=f?o<=f:f<=o;r=0<=f?++o:--o){if(u<=(i=w[r])){n=h[r];break}if(i<=u&&r===w.length-1){n=h[r];break}if(i<u&&u<w[r+1]){u=(u-i)/(w[r+1]-i),n=oe.interpolate(h[r],h[r+1],u,m);break}}else"function"===_e(h)&&(n=h(u));k&&(c[a]=n)}return n},f=function(){return c={}},r(l),(_=function(e){var t;return t=oe(L(e)),n&&t[n]?t[n]():t}).classes=function(e){var t;return null!=e?("array"===_e(e)?d=[(s=e)[0],e[e.length-1]]:(t=oe.analyze(d),s=0===e?[t.min,t.max]:oe.limits(t,"e",e)),_):s},_.domain=function(e){var t,n,r,a,o,i,f;if(!arguments.length)return d;if(g=e[0],b=e[e.length-1],w=[],r=h.length,e.length===r&&g!==b)for(o=0,a=e.length;o<a;o++)n=e[o],w.push((n-g)/(b-g));else for(t=f=0,i=r-1;0<=i?f<=i:i<=f;t=0<=i?++f:--f)w.push(t/(r-1));return d=[g,b],_},_.mode=function(e){return arguments.length?(m=e,f(),_):m},_.range=function(e,t){return r(e),_},_.out=function(e){return n=e,_},_.spread=function(e){return arguments.length?(i=e,_):i},_.correctLightness=function(e){return null==e&&(e=!0),t=e,f(),M=t?function(e){var t,n,r,a,o,i,f,u,c;for(t=L(0,!0).lab()[0],n=L(1,!0).lab()[0],f=n<t,r=L(e,!0).lab()[0],a=r-(o=t+(n-t)*e),u=0,c=1,i=20;.01<Math.abs(a)&&0<i--;)f&&(a*=-1),e+=a<0?.5*(c-(u=e)):.5*(u-(c=e)),r=L(e,!0).lab()[0],a=r-o;return e}:function(e){return e},_},_.padding=function(e){return null!=e?("number"===_e(e)&&(e=[e,e]),v=e,_):v},_.colors=function(t,n){var r,a,e,o,i,f,u,c;if(arguments.length<2&&(n="hex"),i=[],0===arguments.length)i=h.slice(0);else if(1===t)i=[_(.5)];else if(1<t)a=d[0],r=d[1]-a,i=function(){f=[];for(var e=0;0<=t?e<t:t<e;0<=t?e++:e--)f.push(e);return f}.apply(this).map(function(e){return _(a+e/(t-1)*r)});else{if(l=[],u=[],s&&2<s.length)for(e=c=1,o=s.length;1<=o?c<o:o<c;e=1<=o?++c:--c)u.push(.5*(s[e-1]+s[e]));else u=d;i=u.map(function(e){return _(e)})}return oe[n]&&(i=i.map(function(e){return e[n]()})),i},_.cache=function(e){return null!=e?(k=e,_):k},_.gamma=function(e){return null!=e?(p=e,_):p},_},null==oe.scales&&(oe.scales={}),oe.scales.cool=function(){return oe.scale([oe.hsl(180,1,.9),oe.hsl(250,.7,.4)])},oe.scales.hot=function(){return oe.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},oe.analyze=function(e,n,r){var a,t,o,i,f,u;if(f={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==r&&(r=function(){return!0}),a=function(e){null==e||isNaN(e)||(f.values.push(e),f.sum+=e,e<f.min&&(f.min=e),e>f.max&&(f.max=e),f.count+=1)},u=function(e,t){if(r(e,t))return null!=n&&"function"===_e(n)?a(n(e)):null!=n&&"string"===_e(n)||"number"===_e(n)?a(e[n]):a(e)},"array"===_e(e))for(i=0,o=e.length;i<o;i++)u(e[i]);else for(t in e)u(e[t],t);return f.domain=[f.min,f.max],f.limits=function(e,t){return oe.limits(f,e,t)},f},oe.limits=function(e,t,n){var r,a,o,i,f,u,c,l,s,h,d,p,b,g,m,y,v,w,k,_,x,L,M,P,N,C,A,E,j,O,S,R,q,B,F,G,T,I,Y,Q,K,X,z,D,U,H,V,$,W,Z,J,ee,te,ne,re;if(null==t&&(t="equal"),null==n&&(n=7),"array"===_e(e)&&(e=oe.analyze(e)),N=e.min,ue=e.max,e.sum,ne=e.values.sort(function(e,t){return e-t}),1===n)return[N,ue];if(M=[],"c"===t.substr(0,1)&&(M.push(N),M.push(ue)),"e"===t.substr(0,1)){for(M.push(N),_=S=1,F=n-1;1<=F?S<=F:F<=S;_=1<=F?++S:--S)M.push(N+_/n*(ue-N));M.push(ue)}else if("l"===t.substr(0,1)){if(N<=0)throw"Logarithmic scales are only possible for values > 0";for(C=Math.LOG10E*fe(N),P=Math.LOG10E*fe(ue),M.push(N),_=re=1,G=n-1;1<=G?re<=G:G<=re;_=1<=G?++re:--re)M.push(ce(10,C+_/n*(P-C)));M.push(ue)}else if("q"===t.substr(0,1)){for(M.push(N),_=r=1,X=n-1;1<=X?r<=X:X<=r;_=1<=X?++r:--r)R=(ne.length-1)*_/n,(q=ie(R))===R?M.push(ne[q]):(B=R-q,M.push(ne[q]*(1-B)+ne[q+1]*B));M.push(ue)}else if("k"===t.substr(0,1)){for(E=ne.length,g=new Array(E),w=new Array(n),Z=!0,j=0,y=null,(y=[]).push(N),_=a=1,z=n-1;1<=z?a<=z:z<=a;_=1<=z?++a:--a)y.push(N+_/n*(ue-N));for(y.push(ue);Z;){for(x=o=0,D=n-1;0<=D?o<=D:D<=o;x=0<=D?++o:--o)w[x]=0;for(_=i=0,U=E-1;0<=U?i<=U:U<=i;_=0<=U?++i:--i){for(te=ne[_],A=Number.MAX_VALUE,x=f=0,H=n-1;0<=H?f<=H:H<=f;x=0<=H?++f:--f)(k=ae(y[x]-te))<A&&(A=k,m=x);w[m]++,g[_]=m}for(O=new Array(n),x=u=0,V=n-1;0<=V?u<=V:V<=u;x=0<=V?++u:--u)O[x]=null;for(_=c=0,$=E-1;0<=$?c<=$:$<=c;_=0<=$?++c:--c)null===O[v=g[_]]?O[v]=ne[_]:O[v]+=ne[_];for(x=l=0,W=n-1;0<=W?l<=W:W<=l;x=0<=W?++l:--l)O[x]*=1/w[x];for(Z=!1,x=s=0,T=n-1;0<=T?s<=T:T<=s;x=0<=T?++s:--s)if(O[x]!==y[_]){Z=!0;break}y=O,200<++j&&(Z=!1)}for(L={},x=h=0,I=n-1;0<=I?h<=I:I<=h;x=0<=I?++h:--h)L[x]=[];for(_=d=0,Y=E-1;0<=Y?d<=Y:Y<=d;_=0<=Y?++d:--d)L[v=g[_]].push(ne[_]);for(J=[],x=p=0,Q=n-1;0<=Q?p<=Q:Q<=p;x=0<=Q?++p:--p)J.push(L[x][0]),J.push(L[x][L[x].length-1]);for(J=J.sort(function(e,t){return e-t}),M.push(J[0]),_=b=1,K=J.length-1;b<=K;_=b+=2)ee=J[_],isNaN(ee)||-1!==M.indexOf(ee)||M.push(ee)}return M},x=function(e,t,n){var r,a,o,i;return e=(r=xe(arguments))[0],t=r[1],n=r[2],isNaN(e)&&(e=0),(e/=360)<1/3?o=1-((a=(1-t)/3)+(i=(1+t*j(d*e)/j(u-d*e))/3)):e<2/3?a=1-((i=(1-t)/3)+(o=(1+t*j(d*(e-=1/3))/j(u-d*e))/3)):i=1-((o=(1-t)/3)+(a=(1+t*j(d*(e-=2/3))/j(u-d*e))/3)),[255*(i=K(n*i*3)),255*(o=K(n*o*3)),255*(a=K(n*a*3)),3<r.length?r[3]:1]},J=function(){var e,t,n,r,a,o,i;return a=(o=xe(arguments))[0],t=o[1],e=o[2],d=2*Math.PI,a/=255,t/=255,e/=255,0===(i=1-Math.min(a,t,e)/(r=(a+t+e)/3))?n=0:(n=(a-t+(a-e))/2,n/=Math.sqrt((a-t)*(a-t)+(a-e)*(t-e)),n=Math.acos(n),t<e&&(n=d-n),n/=d),[360*n,i,r]},oe.hsi=function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,a=e.apply(r,t);return Object(a)===a?a:r}(C,Ne.call(arguments).concat(["hsi"]),function(){})},s.hsi=x,C.prototype.hsi=function(){return J(this._rgb)},O=function(e,t,n,r){var a,o,i,f,u,c,l,s,h,d;return"hsl"===r?(h=e.hsl(),d=t.hsl()):"hsv"===r?(h=e.hsv(),d=t.hsv()):"hcg"===r?(h=e.hcg(),d=t.hcg()):"hsi"===r?(h=e.hsi(),d=t.hsi()):"lch"!==r&&"hcl"!==r||(r="hcl",h=e.hcl(),d=t.hcl()),"h"===r.substr(0,1)&&(o=h[0],l=h[1],f=h[2],i=d[0],s=d[1],u=d[2]),isNaN(o)||isNaN(i)?isNaN(o)?isNaN(i)?a=Number.NaN:(a=i,1!==f&&0!==f||"hsv"===r||(c=s)):(a=o,1!==u&&0!==u||"hsv"===r||(c=l)):a=o+n*(o<i&&180<i-o?i-(o+360):i<o&&180<o-i?i+360-o:i-o),null==c&&(c=l+n*(s-l)),oe[r](a,c,f+n*(u-f))},q=function(e,t,n,r){var a,o;return a=e.num(),o=t.num(),oe.num(a+(o-a)*n,"num")},(h=h.concat(function(){var e,t,n,r;for(r=[],t=0,e=(n=["hsv","hsl","hsi","hcl","lch","hcg"]).length;t<e;t++)z=n[t],r.push([z,O]);return r}())).push(["num",q]),S=function(e,t,n,r){var a,o;return a=e.lab(),o=t.lab(),new C(a[0]+n*(o[0]-a[0]),a[1]+n*(o[1]-a[1]),a[2]+n*(o[2]-a[2]),r)},h.push(["lab",S])}).call(this)},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={isIOS:function(){return!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)},isAndroid:function(){},isTouch:function(){return"ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints}}},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){for(var e=0,n=0,r=0,a=t.length,o=function(e){return t[e%a][0]},i=function(e){return t[e%a][1]},f=0;f<t.length;f++){var u=o(f)*i(f+1)-o(f+1)*i(f);e+=u,n+=(o(f)+o(f+1))*u,r+=(i(f)+i(f+1))*u}var c=3*e;return[n/c,r/c]}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{}],7:[function(e,t,n){"use strict";var c,a,r,o,i,f=d(e("../config")),u=d(e("chroma-js")),l=d(e("woohaus-utility-belt/lib/getParameterByName")),s=(d(e("woohaus-utility-belt/lib/getCentroid")),d(e("woohaus-utility-belt/lib/numberWithCommas"))),h=d(e("woohaus-utility-belt/lib/checkDevice"));function d(e){return e&&e.__esModule?e:{default:e}}console.log("works"),c=jQuery,a=window,r=document,i={mapboxConfig:{container:"map",style:"mapbox://styles/aosika/cjbepjvcn94182rmrjfnpudra",center:[0,0],zoom:0},mapConfig:{legendReverse:!0,featureHover:!0,mapSelector:".js-choropleth-map"},controlsConfig:{layerAnchorSelector:".js-choropleth-layer-anchor"},featureClickEventCallback:function(e){},updateLayerCallback:function(e,t){}},(o={pluginName:"Choropleth"}).pluginName=function(e){this.options=c.extend(!0,i,e),this.init()},o.pluginName.prototype={map:null,activeLayer:null,activeLayerPropertyKey:null,activeLayerPropertyProperties:null,activeFeature:null,customLayers:[],$mapContainer:c(".choropleth-container"),mapLegend:"mapboxgl-choropleth-legend",mapElement:r.getElementById("map"),touchTime:null,init:function(){this.instantiateMap()},instantiateMap:function(){var n=this,e=void 0;mapboxgl.accessToken=f.default.mapboxAccessToken,(e=new mapboxgl.Map(this.options.mapboxConfig)).doubleClickZoom.disable(),e.addControl(new mapboxgl.NavigationControl,"top-right"),this.map=e,this.createColorScales(),new Promise(function(e,t){n.map.on("load",n.mapLoaded.bind(n,e))}).then(this.afterMapLoaded.bind(this,this.map))},mapLoaded:function(e){e(),this.addMapLayers()},afterMapLoaded:function(e){this.initQueryParamListener(),this.initFeatureClickEvent(),this.initLayerAnchorClickEvent()},addMapLayers:function(){for(var n=this,e=this.map.getStyle().layers,r=void 0,t=0;t<e.length;t++)if("symbol"===e[t].type){r=e[t].id;break}this.options.mapConfig.layers.forEach(function(e,t){n.map.addSource(e.source.id,{type:e.source.type,data:e.source.data}),n.map.addLayer({id:e.id,type:"fill",source:e.source.id,paint:{"fill-color":n.paintFill(e.properties[0]),"fill-opacity":.8,"fill-outline-color":"#000"},layout:{visibility:"none"}},r),h.default.isTouch()||n.initMouseEvents(e),n.customLayers.push(e.id)})},initMouseEvents:function(e){var f=this,u=void 0;this.map.on("mouseenter",e.id,function(e){f.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",e.id,function(e){f.map.getCanvas().style.cursor="",u=void 0,c(".mapboxgl-choropleth-info-box").remove()}),this.map.on("mousemove",e.id,function(e){var t,n=f.map.queryRenderedFeatures(e.point)[0],r=void 0,a=void 0;if(n!==u){u=n,c(".mapboxgl-choropleth-info-box").length&&c(".mapboxgl-choropleth-info-box").remove();var o="";for(var i in n.properties)"name"!==i&&"keys"!==i&&(o+='\n                                <div class="mapboxgl-choropleth-info-box__property">\n                                    <span class="mapboxgl-choropleth-info-box__property-key">'+i+'</span>: <span class="mapboxgl-choropleth-info-box__property-value">'+(0,s.default)(n.properties[i])+"</span>\n                                </div>\n                            ");c(f.options.mapConfig.mapSelector).append('\n                        <div class="mapboxgl-choropleth-info-box">\n                            <h3 class="mapboxgl-choropleth-info-box__title">'+n.properties.name+"</h3>\n                            "+o+"\n                        </div>\n                    ")}r=c(".mapboxgl-choropleth-info-box"),t=parseInt(r.outerWidth()),a=e.originalEvent.clientX+t>f.mapElement.getBoundingClientRect().right?t:0,r.length&&r.css({top:e.originalEvent.clientY-parseInt(r.height())-32+"px",left:e.originalEvent.clientX-a+"px"})})},initQueryParamListener:function(){var t=this;this.checkQueryParam(),a.onpopstate=history.onpushstate=function(e){t.checkQueryParam()}},checkQueryParam:function(){var e=(0,l.default)("layer"),t=(0,l.default)("property");e?t?this.updateLayer(e,t):this.updateLayer(e):this.updateLayer()},updateQueryParam:function(e,t){var n="layer="+e;t&&(n+="&property="+t);var r="?"+n;a.history.pushState("","",r),this.updateLayer(e,t)},createColorScales:function(){this.options.mapConfig.layers.map(function(e){var t=void 0;e.properties.map(function(e){t=u.default.scale(e.colors).mode("lch").colors(e.step.length),e.colorScale=t})})},paintFill:function(n){var r=["step",["get",n.key]];return n.colorScale.map(function(e,t){0<t&&r.push(n.step[t]),r.push(e)}),r},initFeatureClickEvent:function(){var t=this;this.customLayers.forEach(function(e){t.map.on("click",e,t.featureClickEventHandler.bind(t))})},featureEventResponse:function(e){this.activeFeature=e,this.options.featureClickEventCallback(e)},featureTouchStartHandler:function(e){this.touchTime=new Date,console.log("touch start")},featureTouchEndHandler:function(e){var t=new Date-this.touchTime;console.log("touch end initialized"),console.log(t),t<150&&(console.log("touch end condition"),this.activeFeature=e,this.options.featureClickEventCallback(e))},featureClickEventHandler:function(e){this.featureEventResponse(e)},initLayerAnchorClickEvent:function(){c("body").on("click",this.options.controlsConfig.layerAnchorSelector,this.layerAnchorClickEventHandler.bind(this))},layerAnchorClickEventHandler:function(e){e.preventDefault(),e.stopPropagation();var t=c(e.currentTarget).attr("data-layer"),n=c(e.currentTarget).attr("data-prop");this.updateQueryParam(t,n)},revealActiveLayer:function(t){var n=this;this.setActiveLayer(t),this.customLayers.forEach(function(e){e!==t&&n.map.setLayoutProperty(e,"visibility","none")}),"visible"!==this.map.getLayoutProperty(t,"visibility")&&this.map.setLayoutProperty(t,"visibility","visible")},updateLayer:function(e,t){var n=this;e||(e=this.options.mapConfig.layers[0].id),this.revealActiveLayer(e),t?this.findLayer(this.activeLayer).properties.map(function(e){e.key===t&&(n.map.setPaintProperty(n.activeLayer,"fill-color",n.paintFill(e)),n.setActiveProperty(t))}):(this.setActiveProperty(this.findLayer(this.activeLayer).properties[0].key),t=this.findLayer(this.activeLayer).properties[0].key),this.map.setFilter(e,["has",t]),this.addMapLegend(),this.options.updateLayerCallback(this.activeLayer,t)},setActiveLayer:function(e){this.activeLayer=e},findLayer:function(t){var n=void 0;return this.options.mapConfig.layers.map(function(e){e.id===t&&(n=e)}),n},setActivePropertyKey:function(e){this.activeLayerPropertyKey=e},setActiveKeyProperties:function(){var t=this;this.findLayer(this.activeLayer).properties.map(function(e){e.key===t.activeLayerPropertyKey&&(t.activeLayerPropertyProperties=e)})},setActiveProperty:function(e){this.setActivePropertyKey(e),this.setActiveKeyProperties(this)},addMapLegend:function(){var r=this;c("."+this.mapLegend).length&&c("."+this.mapLegend).remove();var e=this.activeLayerPropertyProperties.colorScale,a=this.activeLayerPropertyProperties.step;this.options.mapConfig.legendReverse&&(e=e.slice().reverse(),a=a.slice().reverse());var o="",i=a.length;e.forEach(function(e,t){var n=void 0;n=r.options.mapConfig.legendReverse?0===t?a[t]+"+":a[t]+" – "+a[t-1]:t<i-1?a[t]+" – "+a[t+1]:a[t]+"+",o+='\n                    <div class="mapboxgl-choropleth-legend__row">\n                        <div class="mapboxgl-choropleth-legend__fill" style="background-color: '+e+';"></div>\n                        <div class="mapboxgl-choropleth-legend__row-title">\n                            '+n+"\n                        </div>\n                    </div>\n                "});var t='<h3 class="mapboxgl-choropleth-legend__title">'+this.activeLayerPropertyProperties.title+"</h3>";this.$mapContainer.append('\n                <div class="'+this.mapLegend+'">\n                    <div class="mapboxgl-choropleth-legend__wrapper">\n                        '+t+"\n                        "+o+"\n                    </div>\n                </div>\n            ")}},t.exports=o.pluginName},{"../config":1,"chroma-js":2,"woohaus-utility-belt/lib/checkDevice":3,"woohaus-utility-belt/lib/getCentroid":4,"woohaus-utility-belt/lib/getParameterByName":5,"woohaus-utility-belt/lib/numberWithCommas":6}]},{},[7])(7)});
//# sourceMappingURL=mapboxgl-choropleth.min.js.map
